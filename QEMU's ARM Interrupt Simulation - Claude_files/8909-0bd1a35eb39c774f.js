"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8909],{61867:function(e,t,n){n.d(t,{KX:function(){return h},O3:function(){return x},P2:function(){return f},TD:function(){return y},q2:function(){return b},to:function(){return a},vr:function(){return m}});var r,a,o=n(15489),s=n(97712),i=n(3286);(r=a||(a={})).ReadyForContent="anthropic.claude.usercontent.sandbox.ReadyForContent",r.SetContent="anthropic.claude.usercontent.sandbox.SetContent",r.GetFile="anthropic.claude.usercontent.sandbox.GetFile",r.SendConversationMessage="anthropic.claude.usercontent.sandbox.SendConversationMessage",r.RunCode="anthropic.claude.usercontent.sandbox.RunCode",r.ClaudeCompletion="anthropic.claude.usercontent.sandbox.ClaudeCompletion",r.ReportError="anthropic.claude.usercontent.sandbox.ReportError",r.GetScreenshot="anthropic.claude.usercontent.sandbox.GetScreenshot",r.BroadcastContentSize="anthropic.claude.usercontent.sandbox.BroadcastContentSize";let c=s.z.object({type:s.z.literal("UnsupportedImports"),unsupportedModules:s.z.array(s.z.string()),nonExistentIcons:s.z.array(s.z.string())}),l=s.z.object({type:s.z.literal("RuntimeError"),message:s.z.string()}),u=s.z.object({type:s.z.literal("FileNotFound"),fileName:s.z.string()}),d=s.z.object({type:s.z.literal("ClaudeCompletionError"),message:s.z.string()}),p=s.z.discriminatedUnion("type",[c,l,u,d]),h=s.z.object({code:s.z.string()}),m=s.z.object({status:s.z.enum(["success","error"]),result:s.z.string().optional(),logs:s.z.array(s.z.string()),error:s.z.string().optional()}),g={"anthropic.claude.usercontent.sandbox.SetContent":{requestSchema:i.Zq.extend({method:s.z.literal("anthropic.claude.usercontent.sandbox.SetContent"),payload:s.z.strictObject({"@type":s.z.literal("type.googleapis.com/anthropic.claude.usercontent.sandbox.SandboxContent"),content:s.z.string(),type:s.z.nativeEnum(o.JP),watchContentSize:s.z.boolean().optional()})}),responseSchema:i.AY,alwaysPermitted:!1},"anthropic.claude.usercontent.sandbox.ReadyForContent":{requestSchema:i.Zq.extend({method:s.z.literal("anthropic.claude.usercontent.sandbox.ReadyForContent"),payload:s.z.strictObject({"@type":s.z.literal("type.googleapis.com/google.protobuf.Empty")})}),responseSchema:i.AY,alwaysPermitted:!0},"anthropic.claude.usercontent.sandbox.BroadcastContentSize":{requestSchema:i.Zq.extend({method:s.z.literal("anthropic.claude.usercontent.sandbox.BroadcastContentSize"),payload:s.z.strictObject({"@type":s.z.literal("type.googleapis.com/anthropic.claude.usercontent.sandbox.BroadcastContentSizePayload"),height:s.z.number(),width:s.z.number()})}),responseSchema:i.AY,alwaysPermitted:!1},"anthropic.claude.usercontent.sandbox.GetFile":{requestSchema:i.Zq.extend({method:s.z.literal("anthropic.claude.usercontent.sandbox.GetFile"),payload:s.z.strictObject({key:s.z.string(),"@type":s.z.literal("type.googleapis.com/anthropic.claude.usercontent.sandbox.GetFileRequest")})}),responseSchema:i.Tk.extend({payload:s.z.strictObject({value:s.z.instanceof(Uint8Array).nullable(),"@type":s.z.literal("type.googleapis.com/anthropic.claude.usercontent.sandbox.GetFileResponse")})}),alwaysPermitted:!1},"anthropic.claude.usercontent.sandbox.SendConversationMessage":{requestSchema:i.Zq.extend({method:s.z.literal("anthropic.claude.usercontent.sandbox.SendConversationMessage"),payload:s.z.strictObject({message:s.z.string(),messageType:s.z.enum(["text","error"]),"@type":s.z.literal("type.googleapis.com/anthropic.claude.usercontent.sandbox.SendConversationMessageRequest")})}),responseSchema:i.AY,alwaysPermitted:!1},"anthropic.claude.usercontent.sandbox.RunCode":{requestSchema:i.Zq.extend({method:s.z.literal("anthropic.claude.usercontent.sandbox.RunCode"),payload:s.z.strictObject({code:s.z.string(),"@type":s.z.literal("type.googleapis.com/anthropic.claude.usercontent.sandbox.RunCodeRequest")})}),responseSchema:i.Tk.extend({payload:s.z.strictObject({"@type":s.z.literal("type.googleapis.com/anthropic.claude.usercontent.sandbox.RunCodeResponse")}).merge(m)}),alwaysPermitted:!1},"anthropic.claude.usercontent.sandbox.ClaudeCompletion":{requestSchema:i.Zq.extend({method:s.z.literal("anthropic.claude.usercontent.sandbox.ClaudeCompletion"),payload:s.z.strictObject({prompt:s.z.string(),"@type":s.z.literal("type.googleapis.com/anthropic.claude.usercontent.sandbox.ClaudeCompletionRequest")})}),responseSchema:i.Tk.extend({payload:s.z.strictObject({completion:s.z.string().nullable(),"@type":s.z.literal("type.googleapis.com/anthropic.claude.usercontent.sandbox.ClaudeCompletionResponse")})}),alwaysPermitted:!1},"anthropic.claude.usercontent.sandbox.ReportError":{requestSchema:i.Zq.extend({method:s.z.literal("anthropic.claude.usercontent.sandbox.ReportError"),payload:s.z.strictObject({"@type":s.z.literal("type.googleapis.com/anthropic.claude.usercontent.sandbox.ReportErrorRequest"),error:p})}),responseSchema:i.AY,alwaysPermitted:!0},"anthropic.claude.usercontent.sandbox.GetScreenshot":{requestSchema:i.Zq.extend({method:s.z.literal("anthropic.claude.usercontent.sandbox.GetScreenshot"),payload:s.z.strictObject({"@type":s.z.literal("type.googleapis.com/google.protobuf.Empty")})}),responseSchema:i.Tk.extend({payload:s.z.strictObject({screenshot:s.z.string().nullable(),"@type":s.z.literal("type.googleapis.com/anthropic.claude.usercontent.sandbox.GetScreenshotResponse")})}),alwaysPermitted:!1}},f=s.z.enum(["anthropic.claude.usercontent.sandbox.ReadyForContent","anthropic.claude.usercontent.sandbox.GetFile","anthropic.claude.usercontent.sandbox.SendConversationMessage","anthropic.claude.usercontent.sandbox.ClaudeCompletion","anthropic.claude.usercontent.sandbox.ReportError","anthropic.claude.usercontent.sandbox.BroadcastContentSize"]),b=s.z.discriminatedUnion("method",[g["anthropic.claude.usercontent.sandbox.ReadyForContent"].requestSchema,g["anthropic.claude.usercontent.sandbox.GetFile"].requestSchema,g["anthropic.claude.usercontent.sandbox.SendConversationMessage"].requestSchema,g["anthropic.claude.usercontent.sandbox.ClaudeCompletion"].requestSchema,g["anthropic.claude.usercontent.sandbox.ReportError"].requestSchema,g["anthropic.claude.usercontent.sandbox.BroadcastContentSize"].requestSchema]);s.z.union([i.AY,g["anthropic.claude.usercontent.sandbox.GetFile"].responseSchema,g["anthropic.claude.usercontent.sandbox.SendConversationMessage"].responseSchema,g["anthropic.claude.usercontent.sandbox.ClaudeCompletion"].responseSchema]),s.z.enum(["anthropic.claude.usercontent.sandbox.SetContent","anthropic.claude.usercontent.sandbox.RunCode","anthropic.claude.usercontent.sandbox.GetScreenshot"]),s.z.discriminatedUnion("method",[g["anthropic.claude.usercontent.sandbox.SetContent"].requestSchema,g["anthropic.claude.usercontent.sandbox.RunCode"].requestSchema,g["anthropic.claude.usercontent.sandbox.GetScreenshot"].requestSchema]);let x=s.z.union([g["anthropic.claude.usercontent.sandbox.SetContent"].responseSchema,g["anthropic.claude.usercontent.sandbox.RunCode"].responseSchema,g["anthropic.claude.usercontent.sandbox.GetScreenshot"].responseSchema]),y=Object.entries(g).filter(e=>{let[t,n]=e;return!0===n.alwaysPermitted}).map(e=>{let[t,n]=e;return t})},3286:function(e,t,n){n.d(t,{AY:function(){return c},D7:function(){return l},Kj:function(){return i},Tk:function(){return s},Zq:function(){return o},qV:function(){return a},v8:function(){return u}});var r=n(97712);let a=r.z.object({channel:r.z.enum(["request","response"]),requestId:r.z.string()}).passthrough(),o=a.strict().extend({channel:r.z.literal("request"),method:r.z.string(),payload:r.z.strictObject({"@type":r.z.string()})}),s=a.extend({channel:r.z.literal("response"),status:r.z.number().int().min(100).max(599),payload:r.z.strictObject({"@type":r.z.string()}).passthrough()}).passthrough(),i=s.extend({status:r.z.number().int().min(400).max(599),payload:r.z.strictObject({"@type":r.z.literal("type.googleapis.com/anthropic.claude.usercontent.ErrorResponse"),error:r.z.string()})}),c=s.extend({payload:r.z.strictObject({"@type":r.z.literal("type.googleapis.com/google.protobuf.Empty")})}),l={"@type":"type.googleapis.com/google.protobuf.Empty"},u=e=>({"@type":"type.googleapis.com/anthropic.claude.usercontent.ErrorResponse",error:e})},92829:function(e,t,n){n.d(t,{I:function(){return i}});var r=n(7653),a=n(61867),o=n(3286);class s{setupMessageListener(){window.addEventListener("message",this.boundHandleMessage,!1)}handleMessage(e){if(e.origin!==this.allowedOrigin||e.source!==this.iframe.contentWindow)return;let t=Date.now();if(t-this.lastResetTime>this.RESET_INTERVAL&&(this.messageCount=0,this.lastResetTime=t),this.messageCount++,this.messageCount>this.MAX_MESSAGES_PER_INTERVAL){window.removeEventListener("message",this.boundHandleMessage),this.onRateLimited&&this.onRateLimited();return}let n=o.qV.safeParse(e.data);if(!n.success){console.warn("Received message does not conform to basic message shape, ignoring");return}let r=n.data;if("response"===r.channel){this.handleResponse(r);return}this.messageQueue.push(r),this.isConsumerRunning||this.consumeMessages()}handleResponse(e){let t=this.inFlightRequests.get(e.requestId);if(void 0!==t){t(e);return}}async consumeMessages(){for(this.isConsumerRunning=!0;this.messageQueue.length>0;){let e=this.messageQueue.shift();if(!e)continue;let t=a.P2.safeParse(e.method);if(!t.success){this.sendErrorResponse(e.requestId,400,"Unknown method");continue}let n=t.data,r=a.q2.safeParse(e);if(!r.success){this.sendErrorResponse(e.requestId,400,"Invalid payload content");continue}let s=r.data;if(this.requestLog.has(s.requestId)){this.sendErrorResponse(s.requestId,400,"Request ID already processed");continue}this.requestLog.set(s.requestId,{message:s,requestTimestamp:new Date().getTime()}),await this.onPermissionRequested(n).then(e=>"denied"!==e||(this.sendErrorResponse(s.requestId,403,"Permission denied"),!1)).catch(e=>(console.error("Error checking permission for method ".concat(n,":"),e),this.sendErrorResponse(s.requestId,500,"Error checking permission"),!1))&&(this.onCapabilityAction(s,this.boundSendRequest).then(e=>{var t;let n=o.Tk.parse({channel:"response",status:200,requestId:s.requestId,payload:null!=e?e:o.D7}),r=this.requestLog.get(s.requestId);r&&this.requestLog.set(s.requestId,{...r,response:n,responseTimestamp:new Date().getTime()}),null===(t=this.iframe.contentWindow)||void 0===t||t.postMessage(n,this.allowedOrigin)}).catch(e=>{console.error("Error processing action for method ".concat(n,":"),e),this.sendErrorResponse(s.requestId,500,"Internal server error while processing action")}),await new Promise(e=>requestAnimationFrame(e)))}this.isConsumerRunning=!1}sendErrorResponse(e,t,n){var r;let a=o.Kj.parse({channel:"response",status:t,requestId:e,payload:(0,o.v8)(n)}),s=this.requestLog.get(e);s&&this.requestLog.set(e,{...s,response:a,responseTimestamp:new Date().getTime()}),null===(r=this.iframe.contentWindow)||void 0===r||r.postMessage(a,this.allowedOrigin)}restartListening(){window.removeEventListener("message",this.boundHandleMessage),this.messageCount=0,this.lastResetTime=Date.now(),this.setupMessageListener()}cleanup(){window.removeEventListener("message",this.boundHandleMessage),this.messageQueue=[],this.isConsumerRunning=!1,this.inFlightRequests.clear()}async sendRequest(e,t){return new Promise((n,r)=>{var s;let i=Date.now().toString();this.inFlightRequests.set(i,e=>{let t=o.Tk.safeParse(e);if(!t.success){r(Error("Invalid response format"));return}let s=t.data;if(s.status>=400){let e=o.Kj.safeParse(s);e.success?r(Error(e.data.payload.error)):r(Error("Error response (".concat(s.status,")")));return}let i=a.O3.safeParse(s);i.success?n(i.data.payload):r(Error("Invalid response payload for the method"))}),null===(s=this.iframe.contentWindow)||void 0===s||s.postMessage({channel:"request",method:e,requestId:i,payload:t},this.allowedOrigin)})}getRequestLog(){return Array.from(this.requestLog.entries()).map(e=>{let[t,n]=e;return{...n,requestId:t}}).sort((e,t)=>t.requestTimestamp-e.requestTimestamp)}constructor({iframe:e,allowedOrigin:t,onRateLimited:n=null,onPermissionRequested:r,onCapabilityAction:a}){this.messageCount=0,this.lastResetTime=Date.now(),this.MAX_MESSAGES_PER_INTERVAL=30,this.RESET_INTERVAL=5e3,this.onRateLimited=null,this.messageQueue=[],this.isConsumerRunning=!1,this.requestLog=new Map,this.inFlightRequests=new Map,this.iframe=e,this.allowedOrigin=t,this.onRateLimited=n,this.onPermissionRequested=r,this.onCapabilityAction=a,this.boundHandleMessage=this.handleMessage.bind(this),this.boundSendRequest=this.sendRequest.bind(this),this.setupMessageListener()}}function i(e){let{iframeRef:t,allowedOrigin:n,onRateLimited:o=null,initialPermissions:i,onPermissionRequested:c,onCapabilityAction:l}=e,[u,d]=(0,r.useState)(null),p=(0,r.useRef)(i),[h,m]=(0,r.useState)(0);(0,r.useEffect)(()=>{if(!t.current&&h<20){let e=setTimeout(()=>{m(e=>e+1)},500);return()=>clearTimeout(e)}if(!t.current){console.warn("Max retries reached while waiting for iframe");return}let e=new s({iframe:t.current,allowedOrigin:n,onRateLimited:o,onPermissionRequested:async e=>{if(a.TD.includes(e)||"accepted"===p.current[e])return"accepted";let t=await c(e);return p.current={...p.current,[e]:t},t},onCapabilityAction:l});return d(e),()=>{e.cleanup()}},[t,n,p,o,c,l,h]);let g=(0,r.useCallback)(async(e,t)=>{if(u)return u.sendRequest(e,t);throw Error("Communicator not initialized")},[u]),f=(0,r.useCallback)(()=>{null==u||u.restartListening()},[u]),b=(0,r.useCallback)((e,t)=>{p.current={...p.current,[e]:t}},[]);return{sendRequest:null===u?void 0:g,restartListening:f,permissions:p.current,updatePermission:b}}},2190:function(e,t,n){n.d(t,{i:function(){return l},s:function(){return c}});var r=n(89992),a=n(24550),o=n(7653);function s(e,t){let n=new Map;return t.forEach(e=>{var t;let r=null!==(t=n.get(e.file_name))&&void 0!==t?t:[];r.push(e),n.set(e.file_name,r)}),n.get(e)}function i(e,t){let n=s(e,t);if(!n||0===n.length)return null;let r=n.filter(e=>e.file_kind===a.Y.Blob);return 0===r.length?null:r[r.length-1]}function c(){let e=function(){let e=(0,r.OJ)();return(0,o.useCallback)(async(t,n,r,a,o)=>{let s=i(t,n);if(!s&&a){let n=await e("/api/organizations/".concat(r,"/projects/").concat(a,"/docs")),o=(await n.json()).find(e=>e.file_name===t);if(o)return new TextEncoder().encode(o.content);let c=await e("/api/organizations/".concat(r,"/projects/").concat(a,"/files"));s=i(t,await c.json())}if(!s)return null;try{let e=o?"/api/organizations/".concat(r,"/shared_artifact/").concat(o,"/files/").concat(s.file_uuid,"/contents"):"/api/organizations/".concat(r,"/files/").concat(s.file_uuid,"/contents"),t=await fetch(e);if(!t.ok)return null;let n=await t.arrayBuffer();if(n.byteLength>2147483648-1)return null;return new Uint8Array(n)}catch(e){return null}},[e])}();return(0,o.useCallback)(async(t,n,r,a,o,i)=>a?function(e,t){let n=s(e,t);if(!n||0===n.length)return null;let r=n[n.length-1];if(r){let e=r.extracted_content;return new TextEncoder().encode(e)}return null}(t,n)||await e(t,r,a,o,i):null,[e])}function l(e,t,n,r,a){let s=c();return(0,o.useCallback)(async o=>s(o,e,t,n,r,a),[e,t,n,r,s,a])}},6482:function(e,t,n){n.d(t,{M:function(){return o},T:function(){return a}});var r=n(7653);let a=(0,r.createContext)(null),o=()=>{let e=(0,r.useContext)(a);if(!e)throw Error("usePersistentSandbox must be used within a PersistentSandboxProvider");return e}},57851:function(e,t,n){n.d(t,{McpProvider:function(){return g},c:function(){return m}});var r=n(27573);n(2275);var a=n(21468),o=n(24658),s=n(89194),i=n(28294),c=n(7653),l=n(89992),u=n(88075);i.kO.shape.params;var d=n(57012);class p{start(){return this._port.onmessage=e=>{var t;null===(t=this.onmessage)||void 0===t||t.call(this,e.data)},this._port.onmessageerror=e=>{var t;null===(t=this.onerror)||void 0===t||t.call(this,Error("MessagePort message error: ".concat(e.data)))},Promise.resolve()}close(){var e;return this._port.close(),null===(e=this.onclose)||void 0===e||e.call(this),Promise.resolve()}send(e){return this._port.postMessage(e),Promise.resolve()}constructor(e){this._port=e}}let h=(0,c.createContext)({mcpClients:{},mcpTools:[],isLoading:!1,isEnabled:!1}),m=()=>{let e=(0,c.useContext)(h);return e||console.warn("useMcp being used outside of McpProvider, this is probably a bug"),e};function g(e){let{children:t}=e,[n,s]=(0,c.useState)({}),[p,m]=(0,c.useState)(!1),{addError:g}=(0,o.e)(),{tools:b,onDolphinInterrupted:x}=function(e){let{mcpClients:t}=e,[n,r]=(0,c.useState)([]),s=(0,c.useRef)(!1),l=(0,c.useRef)(null),u=(0,c.useRef)(!1),{addError:p}=(0,o.e)(),{track:h}=(0,a.z$)(),m=(0,c.useCallback)(async(e,n,r)=>{if("auto-dolphin"===e){let e=u.current?'Claude would like to run the tool "'.concat(n.name,'" but was previously interrupted. Do you want to allow this?'):'Claude would like to run the tool "'.concat(n.name,'". Do you want to allow this?');if(s.current&&!confirm(e))return h({event_key:"mcp.tools.called",result:"disallowed",argument_count:Object.keys(r).length}),u.current=!0,{content:[{type:"text",text:"The user has chosen to disallow the tool call."}],isError:!0};l.current=Date.now(),s.current=!1}try{let a=await t[e].callTool({name:n.name,arguments:r},i.M$,{timeout:24e4});if(h({event_key:"mcp.tools.called",result:"success",argument_count:Object.keys(r).length}),"content"in a)return a;return{content:[{type:"text",text:JSON.stringify(a.toolResult,null,2)}],isError:!1}}catch(e){throw p("Failed to call tool ".concat(n.name,": ").concat(e)),h({event_key:"mcp.tools.called",result:"failure",argument_count:Object.keys(r).length}),e}},[p,t,h]);return(0,c.useEffect)(()=>{let e=!1;return async function(){if(!t)return;let n=await (0,d.k)(t,{method:"tools/list",params:{}},i.Gd);e||r(Object.entries(n).map(e=>{var t;let[n,r]=e;return h({event_key:"mcp.tools.listed",tool_count_on_server:r.tools.length}),null!==(t=r.tools.map(e=>({...e,serverName:n,callback:t=>m(n,e,t)})))&&void 0!==t?t:[]}).flat())}(),()=>{e=!0}},[m,t,h]),{tools:n,onDolphinInterrupted:(0,c.useCallback)(()=>{if("number"==typeof l.current&&Date.now()<l.current+100)return},[l])}}({mcpClients:n}),{track:y}=(0,a.z$)();!function(e){let{mcpClients:t}=e,{addError:n}=(0,o.e)(),{track:r}=(0,a.z$)(),{activeOrganization:s}=(0,u.t)(),i=(0,l.uC)("/api/organizations/".concat(null==s?void 0:s.uuid,"/dust/mcp_messages"),"POST",{enabled:!1,onError:()=>n("MCP sampling failed")});(0,c.useEffect)(()=>{},[!1,t,i,r])}({mcpClients:n});let v=(0,c.useCallback)(e=>{if(e.source!==window)return;let{type:t,serverName:n}=e.data;if("mcp-server-connected"!==t||!n)return;let[r]=e.ports;f(r).then(e=>{console.log("Connected to MCP server ".concat(n)),s(t=>({...null!=t?t:{},[n]:e})),"dolphin"===n&&e.setNotificationHandler(i.b5,e=>{"USER_INTERRUPT"===e.params.data&&x()}),y({event_key:"mcp.servers.connected",result:"success"})},e=>{console.error("Could not attach to MCP server ".concat(n,":"),e),g("Could not attach to MCP server ".concat(n)),y({event_key:"mcp.servers.connected",result:"failure"})})},[g,y,x]);(0,c.useEffect)(()=>{window.addEventListener("message",v);let e=!1;async function t(){var t,n;if(!(null===(t=window.claudeAppBindings)||void 0===t?void 0:t.listMcpServers)||!(null===(n=window.claudeAppBindings)||void 0===n?void 0:n.connectToMcpServer))return;let r=await window.claudeAppBindings.listMcpServers();y({event_key:"mcp.servers.listed",server_count:r.length}),e||await Promise.all(r.map(e=>window.claudeAppBindings.connectToMcpServer(e).catch(t=>{console.error("Could not connect to MCP server ".concat(e,":"),t),g("Could not connect to MCP server ".concat(e))})))}return m(!0),t().finally(()=>m(!1)),()=>{e=!0,window.removeEventListener("message",v)}},[v,g,y]);let w=(0,c.useMemo)(()=>Object.keys(n).length>0,[n]);return(0,r.jsx)(h.Provider,{value:{mcpClients:n,mcpTools:b,isLoading:p,isEnabled:w},children:t})}async function f(e){let t=new p(e),n=new s.K({name:"claude-ai",version:"0.1.0"},{capabilities:{}});return await t.start(),await n.connect(t),n}},57012:function(e,t,n){n.d(t,{k:function(){return a}});var r=n(28294);async function a(e,t,n,a){return e?Object.fromEntries((await Promise.all(Object.entries(e).map(async e=>{let[o,s]=e;try{let e=await s.request(t,n,{timeout:5e3,...a});return[o,e]}catch(e){if(e instanceof r.yp&&e.code===r.jK.MethodNotFound)return null;return console.error("Request ".concat(t.method," to ").concat(o," failed: ").concat(e)),null}}))).filter(e=>null!==e)):{}}},11096:function(e,t,n){n.d(t,{z:function(){return u}});var r=n(27573),a=n(41464),o=n(65517),s=n(57908),i=n(87659),c=n(7653);let l=(0,o.j)("inline-flex\n  items-center\n  justify-center\n  relative\n  shrink-0\n  ring-offset-2\n  ring-offset-bg-300\n  ring-accent-main-100\n  focus-visible:outline-none\n  focus-visible:ring-1\n  disabled:pointer-events-none\n  disabled:opacity-50\n  disabled:shadow-none\n  disabled:drop-shadow-none",{variants:{variant:{primary:"\n          bg-accent-main-100\n          bg-gradient-to-r\n          from-accent-main-100\n          via-accent-main-200/50\n          to-accent-main-200\n          bg-[length:200%_100%]\n          hover:bg-right\n          active:bg-accent-main-000\n          border-0.5\n          border-border-300\n          text-oncolor-100\n          font-medium\n          font-styrene\n          drop-shadow-sm\n          transition-all\n          shadow-[inset_0_0.5px_0px_rgba(255,255,0,0.15)]\n          [text-shadow:_0_1px_2px_rgb(0_0_0_/_10%)]\n          active:shadow-[inset_0_1px_6px_rgba(0,0,0,0.2)]\n          hover:from-accent-main-200\n          hover:to-accent-main-200",flat:"bg-accent-main-100\n          text-oncolor-100\n          font-medium\n          font-styrene\n          transition-colors\n          hover:bg-accent-main-200",secondary:"\n          bg-[radial-gradient(ellipse,_var(--tw-gradient-stops))]\n          from-bg-500/10\n          from-50%\n          to-bg-500/30\n          border-0.5\n          border-border-400\n          font-medium\n          font-styrene\n          text-text-100/90\n          transition-colors\n          active:bg-bg-500/50\n          hover:text-text-000\n          hover:bg-bg-500/60",outline:"border-1.5\n          font-medium\n          font-styrene\n          bg-transparent\n          text-text-200\n          transition-colors\n          hover:text-text-100\n          hover:bg-bg-400\n          hover:border-bg-400",ghost:"text-text-200\n          border-transparent\n          transition-colors\n          font-styrene\n          active:bg-bg-400\n          hover:bg-bg-500/40\n          hover:text-text-100",underline:"opacity-80\n          transition-all\n          active:scale-[0.985]\n          hover:opacity-100\n          hover:underline\n          underline-offset-3",danger:"bg-danger-100\n          text-oncolor-100\n          font-medium\n          font-styrene\n          transition-colors\n          hover:bg-danger-200",unstyled:""},size:{default:"h-9 px-4 py-2 rounded-lg min-w-[5rem] active:scale-[0.985] whitespace-nowrap",sm:"h-8 rounded-md px-3 text-xs min-w-[4rem] active:scale-[0.985] whitespace-nowrap",lg:"h-11 rounded-[0.6rem] px-5 min-w-[6rem] active:scale-[0.985] whitespace-nowrap",icon:"h-9 w-9 rounded-md active:scale-95 shrink-0",icon_xs:"h-6 w-6 rounded-md active:scale-95",icon_sm:"h-8 w-8 rounded-md active:scale-95",icon_lg:"h-11 w-11 rounded-[0.6rem] active:scale-95",inline:"px-0.5 rounded-[0.25rem]",unset:""},option:{rounded:"!rounded-full",prepend:"",append:""},state:{active:""}},compoundVariants:[{size:"default",option:"prepend",class:"pl-2 pr-3 gap-1"},{size:"lg",option:"prepend",class:"pl-2.5 pr-3.5 gap-1"},{size:"sm",option:"prepend",class:" pl-2 pr-2.5 gap-1"},{size:"default",option:"append",class:"pl-3 pr-2 gap-1"},{size:"lg",option:"append",class:"pl-3.5 pr-2.5 gap-1"},{size:"sm",option:"append",class:"pl-2.5 pr-2 gap-1"},{variant:"ghost",state:"active",class:"!bg-bg-400"}],defaultVariants:{variant:"primary",size:"default"}}),u=(0,c.forwardRef)((e,t)=>{let{className:n,variant:o,size:c,option:u,loading:d,href:p,target:h,prepend:m,append:g,state:f,disabled:b,children:x,type:y="button",...v}=e;m&&(u="prepend"),g&&(u="append");let w=(0,s.Z)(l({variant:o,size:c,option:u,state:f,className:n}),d&&"text-transparent ![text-shadow:_none]"),z=(0,r.jsxs)(r.Fragment,{children:[d&&(0,r.jsx)("div",{className:(0,s.Z)("absolute inset-0 flex items-center justify-center",o&&"primary"!==o&&"flat"!==o&&"danger"!==o?"text-text-200":"text-oncolor-100"),children:(0,r.jsx)(a.g,{size:"sm",inheritColor:!0})}),m,x,g]});return p?(0,r.jsx)(i.default,{href:p,target:h||"_self",className:w,"aria-label":v["aria-label"],children:z}):(0,r.jsx)("button",{className:w,ref:t,disabled:b||d,type:y,...v,children:z})});u.displayName="Button"},41464:function(e,t,n){n.d(t,{g:function(){return o}});var r=n(27573),a=n(57908);let o=(0,n(7653).memo)(function(e){let{size:t="md",fullscreen:n=!1,inheritColor:o}=e;return(0,r.jsx)("div",{className:(0,a.Z)(n?"fixed left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2":"m-auto"),children:(0,r.jsx)("div",{className:(0,a.Z)("sm"===t&&"h-4 w-4 border-2","md"===t&&"h-20 w-20 border-8",o?"border-current":"border-border-200","text-secondary inline-block animate-spin rounded-full border-solid border-r-transparent align-[-0.125em] motion-reduce:animate-[spin_1.5s_linear_infinite]"),role:"status",children:(0,r.jsx)("span",{className:"sr-only",children:"Loading..."})})})})},15489:function(e,t,n){n.d(t,{An:function(){return C},HZ:function(){return R},JP:function(){return a},Km:function(){return y},VA:function(){return p},kE:function(){return u},l2:function(){return v},tE:function(){return S},w0:function(){return z},yc:function(){return d}});var r,a,o,s=n(97712),i=n(92068),c=n(6932);(r=a||(a={})).Text="text/plain",r.Markdown="text/markdown",r.Html="text/html",r.Code="application/vnd.ant.code",r.Svg="image/svg+xml",r.Mermaid="application/vnd.ant.mermaid",r.React="application/vnd.ant.react",(o||(o={})).Repl="application/vnd.ant.repl";let l=s.z.string().nullish().transform(e=>null!=e?e:void 0),u=s.z.object({version_uuid:l,command:s.z.enum(["create","update","rewrite"]).optional().catch(void 0),id:l,title:l,type:s.z.nativeEnum(a).optional().catch(void 0),language:l,content:l,old_str:l,new_str:l}),d={"text/plain":{syntaxName:"plaintext",displayName:"text",extension:()=>"txt"},"text/markdown":{syntaxName:"markdown",displayName:"document",extension:()=>"md"},"text/html":{syntaxName:"html",displayName:"website",extension:()=>"html"},"image/svg+xml":{syntaxName:"svg",displayName:"image",extension:()=>"svg"},"application/vnd.ant.code":{syntaxName:"plaintext",displayName:"code",extension:e=>{switch(null==e?void 0:e.language){case"python":return"py";case"javascript":return"js";case"typescript":return"ts";case"java":return"java";case"csharp":return"cs";case"go":return"go";case"rust":return"rs";case"ruby":return"rb";case"php":return"php";case"swift":return"swift";case"kotlin":return"kt";case"dart":return"dart";case"scala":return"scala";case"perl":return"pl";case"elixir":return"ex";case"haskell":return"hs";case"clojure":return"clj";case"r":return"r";case"groovy":return"groovy";case"bash":return"sh";case"css":return"css";case"scss":return"scss";case"less":return"less";case"sql":return"sql";case"graphql":return"graphql";case"json":return"json";case"html":return"html";default:return"txt"}}},"application/vnd.ant.mermaid":{syntaxName:"mermaid",displayName:"diagram",extension:()=>"mermaid"},"application/vnd.ant.react":{syntaxName:"tsx",displayName:"component",extension:()=>"tsx"}},p=e=>{let t=d[e.type];return"application/vnd.ant.code"!==e.type?t.extension():t.extension(e)},h="antArtifact",m="<".concat(h,"(?:\\s+([^>]*)>|(?!>)\\S*)"),g="</".concat(h,">"),f=RegExp("".concat(m,"([\\s\\S]*?)(?:").concat(g,"|$)"),"g"),b=RegExp("<(?:a(?:n(?:t(?:A(?:r(?:t(?:i(?:f(?:a(?:c(?:t)?)?)?)?)?)?)?)?)?)?)?$","gm"),x=RegExp("".concat(m,"[\\s\\S]*?(?:").concat(g,"|$)"),"g"),y="ANTARTIFACTLINK";function v(e){var t;let n=e.match(/identifier="([^"]*)"/),r=n?n[1]:"",o=e.match(/type="([^"]*)"/),s=o?(t=o[1],Object.values(a).includes(t)?t:"text/plain"):"text/plain",i=e.match(/title="([^"]*)"/),c=i?i[1]:"Untitled artifact",l=e.match(/language="([^"]*)"/),u=l?l[1]:void 0,d=e.match(/isClosed="(true|false)"/);return{id:r,type:s,title:c,language:u,isClosed:d?"true"===d[1]:void 0}}function w(e){return e.replace(b,"")}function z(e){return k(w(e)).replace(f,(e,t,n)=>{if(!t||"string"!=typeof t)return"";{let{type:e,language:r}=v(t);return"text/markdown"!==e&&"string"==typeof n?"```".concat(r||d[e].syntaxName,"\n").concat(n.trimStart(),"\n```"):"\n".concat(n)}})}function C(e){return w(k(e).replace(x,(e,t)=>{let n=e.endsWith(g);return"<".concat(y," ").concat(t,' isClosed="').concat(n,'" />')}))}let S=(e,t)=>"create"===e.command||"rewrite"===e.command?e.content:"update"===e.command?void 0===t?e.new_str:t.includes(e.old_str)?t.replace(e.old_str,e.new_str):t.replace(e.old_str.trim(),e.new_str):null!=t?t:"";function R(e){var t;let n=(0,i.K)(e).matchAll(f),r=[];for(let t of n){let[n,a,o]=t,s=n.endsWith(g);if(!a||!o)continue;let{id:i,type:c,title:l,language:u}=v(a),d={command:"create",message:e.uuid||"",created_at:e.created_at,content:o.trimStart(),isClosed:s};r.push({id:i,currentVersion:d,type:c,title:l,language:u})}return null===(t=e.content)||void 0===t||t.map((t,n,a)=>{if("tool_use"===t.type&&"artifacts"===t.name&&t.input){let o;let s=(0,c.n)(t),i=n===a.length-1,{version_uuid:l,command:d,id:p,type:h="text/plain",title:m="",language:g,content:f="",old_str:b="",new_str:x=""}=u.parse(s);"create"===d||"rewrite"===d?o={uuid:l,command:d,message:e.uuid||"",created_at:e.created_at,content:f.trimStart(),isClosed:!i}:"update"===d&&""!==f?o={uuid:l,command:"rewrite",message:e.uuid||"",created_at:e.created_at,isClosed:!i,content:f}:"update"===d&&(o={uuid:l,command:"update",message:e.uuid||"",created_at:e.created_at,isClosed:!i,old_str:b,new_str:x}),void 0!==p&&void 0!==o&&r.push({id:p,currentVersion:o,type:h,title:m,language:g})}}),r}let q="antThinking",_="<".concat(q,">"),E=RegExp("".concat(_,"[\\s\\S]*?(?:</").concat(q,">|$)"),"g"),j=RegExp("<(?:a(?:n(?:t(?:T(?:h(?:i(?:n(?:k(?:i(?:n(?:g)?)?)?)?)?)?)?)?)?)?)?$","gm");function k(e){return e.replace(j,"").replace(E,"")}},24550:function(e,t,n){var r,a;n.d(t,{Y:function(){return r}}),(a=r||(r={})).Image="image",a.Blob="blob",a.SanitizedDocument="document"},90216:function(e,t,n){n.d(t,{g:function(){return r}});function r(e){let t=function(e){let t=[],n=0;for(;n<e.length;){let r=e[n];if(/\s/.test(r)){n++;continue}if("{[]}:,".includes(r)){t.push(r),n++;continue}if('"'===r){let a=r;n++;let o=!1,s=!1;for(;n<e.length;){if(a+=r=e[n],'"'===r&&!o){s=!0;break}o="\\"===r&&!o,n++}if(!s){if(a.slice(-5).includes("\\"))for(a=a.slice(0,a.lastIndexOf("\\"));a.endsWith("\\");)a=a.slice(0,-1);a+='"'}t.push(a),n++;continue}if(/[-0-9]/.test(r)){let r="";for(;n<e.length&&/[-0-9.eE+]/.test(e[n]);)r+=e[n],n++;if(!r.match(/\d$/))for(;r.length>0&&!r[r.length-1].match(/\d/);)r=r.slice(0,-1);t.push(r);continue}if(/[tfn]/.test(r)){let a="",o=["true","false","null"],s=o.filter(e=>e.startsWith(r));if(1===s.length)n+=(a=s[0]).length;else for(;n<e.length&&/[a-z]/.test(e[n])&&(a+=e[n],n++,!o.includes(a)););o.includes(a)&&t.push(a);continue}n++}return t}(e),n=[];for(let e of t)"{"===e||"["===e?n.push("{"===e?"}":"]"):("}"===e||"]"===e)&&n.length>0&&n.pop();n.reverse(),","===t[t.length-1]&&t.pop();let r=t.concat(n).join("");if(""===r)return null;try{return JSON.parse(r)}catch(r){let e=Math.max(t.lastIndexOf(","),t.lastIndexOf("{"),t.lastIndexOf("["));if(-1!==e){let r=t.slice(0,e+1);return","===r[r.length-1]&&r.pop(),JSON.parse(r.concat(n).join(""))}throw Error("Invalid JSON")}}},6932:function(e,t,n){n.d(t,{n:function(){return a}});var r=n(90216);let a=e=>{if(e.input&&Object.keys(e.input).length>0)return e.input;if(e.partial_json){let t={};try{t=(0,r.g)(e.partial_json)}catch(e){}return null!=t?t:{}}return{}}}}]);